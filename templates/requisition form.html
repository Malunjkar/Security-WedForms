<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Requisition for Entry Permit</title>

    <link rel="stylesheet" href="{{ url_for('static', filename='css/pil_requisition_form.css') }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
</head>

<body>

    <header class="header-dashboard">
        <div class="hamburger-dashboard">
            ☰
            <a href="{{ url_for('routes_bp.home') }}">
                <img src="{{ url_for('static', filename='img/logo.png') }}" class="logo-dashboard">
            </a>
        </div>

        <h2>Requisition Form</h2>

        <div id="profileAvatar">
            <div id="profileInitials">
                {{ (session.get('user') or {}).get('name','GU')[:2].upper() }}
            </div>
            <span>{{ (session.get('user') or {}).get('name','Guest User') }}</span>
        </div>
    </header>

    <div class="container">

        <!-- ================= PAGINATION ================= -->
        <div class="toolbar" id="paginationBar">
            <div class="pagination">
                <button id="prevBtn">◀ Back</button>
                <span id="pageInfo"></span>
                <button id="nextBtn">Next ▶</button>
            </div>
        </div>

        <!-- ================= LIST VIEW ================= -->
        <div id="listView">
            <table id="masterTable">
                <thead>
                    <tr>
                        <th>Sr. No.</th>
                        <th>Location</th>
                        <th>Request Date</th>
                        <th>Contractor Name</th>
                        <th>Name of Agency</th>
                        <th>SAP Vendor Code</th>
                        {% if user_role != 'admin' %}
                        <th>Action</th>
                        {% endif %}
                    </tr>
                </thead>
                <tbody></tbody>
            </table>

            <div class="table-footer">
                {% if user_role != 'admin' %}
                <button class="btn-add" onclick="openAddForm()">Add Data</button>
                {% endif %}
                <button class="btn-download" onclick="downloadTable()">
                    <i class="fa fa-download"></i> Download
                </button>
            </div>
        </div>

        <!-- ================= FULL FORM VIEW ================= -->
        <form id="requisitionForm">
            <div id="formView" class="form-box">

                <h3>Basic Details</h3>

                <div class="row">
                    <div class="field">
                        <label>Date of Request</label>
                        <input type="date" id="dt_request_date" required>
                    </div>
                    <div class="field">
                        <label>Location</label>
                        <input id="s_location" readonly value="{{ session['user']['location'] }}">
                    </div>
                </div>

                <div class="row">
                    <div class="field"><label>First Name</label><input id="s_first_name" required></div>
                    <div class="field"><label>Middle Name</label><input id="s_middle_name"></div>
                    <div class="field"><label>Last Name</label><input id="s_last_name" required></div>
                </div>

                <div class="row">
                    <div class="field"><label>Date of Birth</label><input type="date" id="dt_date_of_birth" required>
                    </div>
                    <div class="field"><label>Age (Years)</label><input id="n_age" required></div>
                </div>

                <div class="row">
                    <div class="field"><label>Name of Agency</label><input id="s_agency_name" required></div>
                    <div class="field"><label>SAP Vendor Code</label><input id="s_sap_vendor_code"></div>
                </div>

                <div class="row">
                    <div class="field"><label>Nature of Job</label><input id="s_nature_of_job" required></div>
                    <div class="field"><label>Work Order No</label><input id="s_work_order_no" required></div>
                    <div class="field"><label>Work Order Validity</label><input type="date" id="dt_work_order_validity"
                            required></div>
                </div>

                <div class="row">
                    <div class="field"><label>Date of Joining</label><input type="date" id="dt_date_of_joining"
                            required></div>
                    <div class="field"><label>Exact Location of Work</label><input id="s_exact_work_location" required>
                    </div>
                </div>

                <div class="row">
                    <div class="field"><label>Height (cm)</label><input id="n_height_cm"></div>
                    <div class="field">
                        <label>Gender</label>
                        <select id="s_gender" required>
                            <option value="">Select</option>
                            <option>Male</option>
                            <option>Female</option>
                            <option>Other</option>
                        </select>
                    </div>
                    <div class="field"><label>Blood Group</label><input id="s_blood_group"></div>
                </div>

                <div class="row">
                    <div class="field"><label>Aadhar Card No</label><input id="s_aadhar_card_no" required></div>
                </div>

                <div class="row">
                    <div class="field"><label>Present Address</label><textarea id="s_present_address"
                            required></textarea></div>
                </div>

                <div class="row">
                    <div class="field"><label>City</label><input id="s_present_city" required></div>
                    <div class="field"><label>State</label><input id="s_present_state" required></div>
                    <div class="field"><label>Pin Code</label><input id="s_present_pincode" required></div>
                    <div class="field"><label>Contact No</label><input id="s_contact_no" required></div>
                </div>

                <h3>Emergency Contact</h3>

                <div class="row">
                    <div class="field"><textarea id="s_emergency_contact_details" required></textarea></div>
                </div>

                <div class="row">
                    <div class="field"><input id="s_emergency_city" required></div>
                    <div class="field"><input id="s_emergency_state" required></div>
                    <div class="field"><input id="s_emergency_pincode" required></div>
                    <div class="field"><input id="s_emergency_contact_no" required></div>
                </div>

                <h3>Certificates</h3>
                <div class="row">
                    <label><input type="checkbox" id="s_police_verification_cert"> Police Verification</label>
                    <label><input type="checkbox" id="s_medical_certificate"> Medical</label>
                    <label><input type="checkbox" id="s_govt_id_proof"> Govt ID</label>
                    <label><input type="checkbox" id="s_hsse_training"> HSSE</label>
                </div>

                <h3>Approvals</h3>
                <div class="row">
                    <div class="field"><input id="s_contractor_name" required></div>
                    <div class="field"><input id="s_engineer_name" required></div>
                    <div class="field"><input id="s_area_manager_name" required></div>
                </div>

                <div class="row">
                    <div class="field"><input id="s_security_ic_name" required></div>
                </div>

                <div class="row">
                    <div class="field"><input id="s_entry_permit_no" required></div>
                    <div class="field"><input type="date" id="dt_date_of_issue" required></div>
                </div>

                <div class="btn-row">
                    <button type="button" class="btn-save" onclick="saveRequisition()">Save</button>
                    <button type="button" class="secondary" onclick="cancel()">Cancel</button>
                </div>

            </div>
        </form>


    </div>

    <script>
        const USER_LOCATION = "{{ session['user']['location'] }}";
    </script>
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script src="{{ url_for('static', filename='javascript/pil_requisition_form.js') }}"></script>

</body>

</html>